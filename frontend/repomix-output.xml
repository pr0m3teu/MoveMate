This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.gitignore
components.json
eslint.config.js
index.html
package.json
public/vite.svg
README.md
src/App.tsx
src/assets/react.svg
src/components/layout/Overlay.tsx
src/components/ui/badge.tsx
src/components/ui/button.tsx
src/components/ui/card.tsx
src/components/ui/input.tsx
src/features/bounty/BountyList.tsx
src/features/bounty/BountyView.tsx
src/features/chat/ChatView.tsx
src/features/gas/GasView.tsx
src/features/scanner/ScannerView.tsx
src/features/txlab/TxLabView.tsx
src/index.css
src/lib/API.ts
src/lib/utils.ts
src/main.tsx
tsconfig.app.json
tsconfig.json
tsconfig.node.json
vite.config.ts
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".gitignore">
# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*
lerna-debug.log*

node_modules
dist
dist-ssr
*.local

# Editor directories and files
.vscode/*
!.vscode/extensions.json
.idea
.DS_Store
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?
</file>

<file path="components.json">
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "new-york",
  "rsc": false,
  "tsx": true,
  "tailwind": {
    "config": "",
    "css": "src/index.css",
    "baseColor": "neutral",
    "cssVariables": true,
    "prefix": ""
  },
  "iconLibrary": "lucide",
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  },
  "registries": {}
}
</file>

<file path="eslint.config.js">
import js from '@eslint/js'
import globals from 'globals'
import reactHooks from 'eslint-plugin-react-hooks'
import reactRefresh from 'eslint-plugin-react-refresh'
import tseslint from 'typescript-eslint'
import { defineConfig, globalIgnores } from 'eslint/config'

export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      js.configs.recommended,
      tseslint.configs.recommended,
      reactHooks.configs.flat.recommended,
      reactRefresh.configs.vite,
    ],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
    },
  },
])
</file>

<file path="index.html">
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>frontend</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
</file>

<file path="package.json">
{
  "name": "frontend",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc -b && vite build",
    "lint": "eslint .",
    "preview": "vite preview"
  },
  "dependencies": {
    "@mysten/dapp-kit": "^0.19.11",
    "@mysten/sui": "^1.45.2",
    "@mysten/sui.js": "^0.54.1",
    "@radix-ui/react-slot": "^1.2.4",
    "@tailwindcss/vite": "^4.1.18",
    "@tanstack/react-query": "^5.90.12",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "lucide-react": "^0.561.0",
    "react": "^19.2.0",
    "react-dom": "^19.2.0",
    "react-markdown": "^10.1.0",
    "recharts": "^3.5.1",
    "tailwind-merge": "^3.4.0",
    "tailwindcss": "^4.1.18"
  },
  "devDependencies": {
    "@eslint/js": "^9.39.1",
    "@types/node": "^24.10.3",
    "@types/react": "^19.2.5",
    "@types/react-dom": "^19.2.3",
    "@vitejs/plugin-react": "^5.1.1",
    "eslint": "^9.39.1",
    "eslint-plugin-react-hooks": "^7.0.1",
    "eslint-plugin-react-refresh": "^0.4.24",
    "globals": "^16.5.0",
    "tw-animate-css": "^1.4.0",
    "typescript": "~5.9.3",
    "typescript-eslint": "^8.46.4",
    "vite": "^7.2.4"
  }
}
</file>

<file path="public/vite.svg">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="31.88" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 257"><defs><linearGradient id="IconifyId1813088fe1fbc01fb466" x1="-.828%" x2="57.636%" y1="7.652%" y2="78.411%"><stop offset="0%" stop-color="#41D1FF"></stop><stop offset="100%" stop-color="#BD34FE"></stop></linearGradient><linearGradient id="IconifyId1813088fe1fbc01fb467" x1="43.376%" x2="50.316%" y1="2.242%" y2="89.03%"><stop offset="0%" stop-color="#FFEA83"></stop><stop offset="8.333%" stop-color="#FFDD35"></stop><stop offset="100%" stop-color="#FFA800"></stop></linearGradient></defs><path fill="url(#IconifyId1813088fe1fbc01fb466)" d="M255.153 37.938L134.897 252.976c-2.483 4.44-8.862 4.466-11.382.048L.875 37.958c-2.746-4.814 1.371-10.646 6.827-9.67l120.385 21.517a6.537 6.537 0 0 0 2.322-.004l117.867-21.483c5.438-.991 9.574 4.796 6.877 9.62Z"></path><path fill="url(#IconifyId1813088fe1fbc01fb467)" d="M185.432.063L96.44 17.501a3.268 3.268 0 0 0-2.634 3.014l-5.474 92.456a3.268 3.268 0 0 0 3.997 3.378l24.777-5.718c2.318-.535 4.413 1.507 3.936 3.838l-7.361 36.047c-.495 2.426 1.782 4.5 4.151 3.78l15.304-4.649c2.372-.72 4.652 1.36 4.15 3.788l-11.698 56.621c-.732 3.542 3.979 5.473 5.943 2.437l1.313-2.028l72.516-144.72c1.215-2.423-.88-5.186-3.54-4.672l-25.505 4.922c-2.396.462-4.435-1.77-3.759-4.114l16.646-57.705c.677-2.35-1.37-4.583-3.769-4.113Z"></path></svg>
</file>

<file path="README.md">
# React + TypeScript + Vite

This template provides a minimal setup to get React working in Vite with HMR and some ESLint rules.

Currently, two official plugins are available:

- [@vitejs/plugin-react](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react) uses [Babel](https://babeljs.io/) (or [oxc](https://oxc.rs) when used in [rolldown-vite](https://vite.dev/guide/rolldown)) for Fast Refresh
- [@vitejs/plugin-react-swc](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react-swc) uses [SWC](https://swc.rs/) for Fast Refresh

## React Compiler

The React Compiler is not enabled on this template because of its impact on dev & build performances. To add it, see [this documentation](https://react.dev/learn/react-compiler/installation).

## Expanding the ESLint configuration

If you are developing a production application, we recommend updating the configuration to enable type-aware lint rules:

```js
export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      // Other configs...

      // Remove tseslint.configs.recommended and replace with this
      tseslint.configs.recommendedTypeChecked,
      // Alternatively, use this for stricter rules
      tseslint.configs.strictTypeChecked,
      // Optionally, add this for stylistic rules
      tseslint.configs.stylisticTypeChecked,

      // Other configs...
    ],
    languageOptions: {
      parserOptions: {
        project: ['./tsconfig.node.json', './tsconfig.app.json'],
        tsconfigRootDir: import.meta.dirname,
      },
      // other options...
    },
  },
])
```

You can also install [eslint-plugin-react-x](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-x) and [eslint-plugin-react-dom](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-dom) for React-specific lint rules:

```js
// eslint.config.js
import reactX from 'eslint-plugin-react-x'
import reactDom from 'eslint-plugin-react-dom'

export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      // Other configs...
      // Enable lint rules for React
      reactX.configs['recommended-typescript'],
      // Enable lint rules for React DOM
      reactDom.configs.recommended,
    ],
    languageOptions: {
      parserOptions: {
        project: ['./tsconfig.node.json', './tsconfig.app.json'],
        tsconfigRootDir: import.meta.dirname,
      },
      // other options...
    },
  },
])
```
</file>

<file path="src/App.tsx">
import { useState, useEffect } from "react"
import { Shield, MessageSquare, Search, CheckCircle, ArrowUpRight, LayoutTemplate, Wallet, Code2 } from "lucide-react"
import { cn } from "@/lib/utils"

import { Overlay } from "@/components/layout/Overlay"

import { ChatView } from "@/features/chat/ChatView"
import { BountyView } from "@/features/bounty/BountyView"
import { TxLabView } from "@/features/txlab/TxLabView"
import { ConnectButton } from '@mysten/dapp-kit';

// Componentă UI Locală (Dashboard Card)
const DashboardCard = ({ title, description, icon: Icon, color, onClick }: any) => {
  const colorStyles: any = {
    blue: "text-blue-400 group-hover:text-blue-300 bg-blue-500/10 group-hover:bg-blue-500/20 shadow-[0_0_20px_rgba(59,130,246,0.1)]",
    emerald: "text-emerald-400 group-hover:text-emerald-300 bg-emerald-500/10 group-hover:bg-emerald-500/20 shadow-[0_0_20px_rgba(16,185,129,0.1)]",
    yellow: "text-yellow-400 group-hover:text-yellow-300 bg-yellow-500/10 group-hover:bg-yellow-500/20 shadow-[0_0_20px_rgba(234,179,8,0.1)]",
  }
  return (
    <div 
      onClick={onClick}
      className="group relative overflow-hidden rounded-2xl border border-slate-800 bg-slate-900/40 p-8 transition-all hover:-translate-y-1 hover:border-slate-700 hover:shadow-2xl cursor-pointer"
    >
      <div className="absolute top-0 right-0 -mt-8 -mr-8 h-32 w-32 rounded-full bg-gradient-to-br from-white/5 to-transparent blur-3xl transition-all group-hover:from-white/10" />
      <div className={cn("mb-6 inline-flex h-12 w-12 items-center justify-center rounded-xl transition-all duration-300", colorStyles[color])}>
        <Icon size={24} />
      </div>
      <h3 className="mb-2 text-xl font-bold text-white group-hover:text-blue-100 transition-colors">{title}</h3>
      <p className="text-slate-400 leading-relaxed text-sm">{description}</p>
    </div>
  )
}

const StatCard = ({ label, value, icon: Icon }: any) => (
  <div className="rounded-xl border border-slate-800/60 bg-slate-900/30 p-4 flex items-center space-x-4 hover:bg-slate-900/50 transition-colors">
    <div className="p-2.5 bg-slate-800 rounded-lg text-slate-400">
      <Icon size={18} />
    </div>
    <div>
      <p className="text-[10px] text-slate-500 uppercase font-bold tracking-wider">{label}</p>
      <p className="text-lg font-bold text-white font-mono">{value}</p>
    </div>
  </div>
)

export default function App() {
  const [activeOverlay, setActiveOverlay] = useState<string | null>(null)

  useEffect(() => {
    const handleEsc = (e: KeyboardEvent) => e.key === 'Escape' && setActiveOverlay(null)
    window.addEventListener('keydown', handleEsc)
    return () => window.removeEventListener('keydown', handleEsc)
  }, [])

  return (
    <div className="relative min-h-screen bg-[#020617] font-sans text-slate-200 selection:bg-blue-500/30 overflow-hidden">
      
      {/* BACKGROUND LAYER (Dashboard) */}
      <div 
        className={cn(
          "min-h-screen transition-all duration-500 ease-[cubic-bezier(0.32,0.72,0,1)]",
          activeOverlay ? "scale-[0.95] opacity-50 blur-[2px] pointer-events-none grayscale-[0.5]" : "scale-100 opacity-100"
        )}
      >
        <header className="fixed top-0 w-full z-10 border-b border-slate-800/50 bg-[#020617]/80 backdrop-blur-xl">
          <div className="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
            <div className="flex items-center space-x-3">
              <div className="w-8 h-8 rounded-lg bg-gradient-to-tr from-blue-600 to-cyan-500 flex items-center justify-center shadow-[0_0_15px_rgba(37,99,235,0.5)]">
                <Shield className="text-white h-5 w-5" />
              </div>
              <span className="font-bold text-lg text-white">MoveMate</span>
            </div>
            <div className="flex items-center gap-4">
   <ConnectButton />
</div>
          </div>
        </header>

        <main className="pt-32 pb-20 px-6 max-w-7xl mx-auto">
          <div className="mb-16 text-center space-y-4">
             <h1 className="text-5xl md:text-7xl font-bold tracking-tight text-white">
              Securitate pentru <span className="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-300">Move Smart Contracts</span>
            </h1>
            <p className="text-lg text-slate-400 max-w-2xl mx-auto pt-4 leading-relaxed">
              Platforma completă de audit AI. Detectează vulnerabilități, simulează costurile de gaz și oferă consultanță tehnică bazată pe documentația oficială Sui.
            </p>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
            <DashboardCard 
              title="MoveCall Sandbox" 
              description="Încarcă ABI on-chain, simulează (dev-inspect) și execută entry functions."
              icon={Code2} 
              color="blue" 
              onClick={() => setActiveOverlay('txlab')} 
            />
            <DashboardCard 
              title="Asistent Arhitect" 
              description="Chatbot antrenat pe documentația Sui Move (RAG)."
              icon={MessageSquare} 
              color="emerald" 
              onClick={() => setActiveOverlay('chat')} 
            />
            <DashboardCard 
              title="Bounty & Escalation" 
              description="Escaladează către auditori umani: escrow 10 SUI, claim, fix proof (IPFS/GitHub), release/timeout + dispute."
              icon={Wallet} 
              color="yellow" 
              onClick={() => setActiveOverlay('bounty')} 
            />
          </div>

          <div className="mt-12 grid grid-cols-1 md:grid-cols-4 gap-4">
            <StatCard label="Scanări Totale" value="12,403" icon={Search} />
            <StatCard label="Bounties Plătite" value="45,200 SUI" icon={CheckCircle} />
            <StatCard label="Escalări Active" value="128" icon={ArrowUpRight} />
            <div className="md:col-span-1 rounded-xl border border-dashed border-slate-800 bg-slate-900/20 flex items-center justify-center text-slate-500 text-sm hover:border-slate-700 hover:text-slate-300 cursor-pointer transition-colors p-4 group">
              <LayoutTemplate className="w-4 h-4 mr-2 group-hover:text-blue-400 transition-colors" /> Vezi Istoric Audituri
            </div>
          </div>
        </main>
      </div>

      {/* OVERLAY LAYERS (Conținutul care apare) */}
      <Overlay isOpen={activeOverlay === 'txlab'} onClose={() => setActiveOverlay(null)} title="MoveCall Sandbox">
        <TxLabView />
      </Overlay>

      <Overlay isOpen={activeOverlay === 'chat'} onClose={() => setActiveOverlay(null)} title="Move Architect">
        <ChatView />
      </Overlay>

      <Overlay isOpen={activeOverlay === 'bounty'} onClose={() => setActiveOverlay(null)} title="Bounty Protocol">
        <BountyView />
      </Overlay>

    </div>
  )
}
</file>

<file path="src/assets/react.svg">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="35.93" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 228"><path fill="#00D8FF" d="M210.483 73.824a171.49 171.49 0 0 0-8.24-2.597c.465-1.9.893-3.777 1.273-5.621c6.238-30.281 2.16-54.676-11.769-62.708c-13.355-7.7-35.196.329-57.254 19.526a171.23 171.23 0 0 0-6.375 5.848a155.866 155.866 0 0 0-4.241-3.917C100.759 3.829 77.587-4.822 63.673 3.233C50.33 10.957 46.379 33.89 51.995 62.588a170.974 170.974 0 0 0 1.892 8.48c-3.28.932-6.445 1.924-9.474 2.98C17.309 83.498 0 98.307 0 113.668c0 15.865 18.582 31.778 46.812 41.427a145.52 145.52 0 0 0 6.921 2.165a167.467 167.467 0 0 0-2.01 9.138c-5.354 28.2-1.173 50.591 12.134 58.266c13.744 7.926 36.812-.22 59.273-19.855a145.567 145.567 0 0 0 5.342-4.923a168.064 168.064 0 0 0 6.92 6.314c21.758 18.722 43.246 26.282 56.54 18.586c13.731-7.949 18.194-32.003 12.4-61.268a145.016 145.016 0 0 0-1.535-6.842c1.62-.48 3.21-.974 4.76-1.488c29.348-9.723 48.443-25.443 48.443-41.52c0-15.417-17.868-30.326-45.517-39.844Zm-6.365 70.984c-1.4.463-2.836.91-4.3 1.345c-3.24-10.257-7.612-21.163-12.963-32.432c5.106-11 9.31-21.767 12.459-31.957c2.619.758 5.16 1.557 7.61 2.4c23.69 8.156 38.14 20.213 38.14 29.504c0 9.896-15.606 22.743-40.946 31.14Zm-10.514 20.834c2.562 12.94 2.927 24.64 1.23 33.787c-1.524 8.219-4.59 13.698-8.382 15.893c-8.067 4.67-25.32-1.4-43.927-17.412a156.726 156.726 0 0 1-6.437-5.87c7.214-7.889 14.423-17.06 21.459-27.246c12.376-1.098 24.068-2.894 34.671-5.345a134.17 134.17 0 0 1 1.386 6.193ZM87.276 214.515c-7.882 2.783-14.16 2.863-17.955.675c-8.075-4.657-11.432-22.636-6.853-46.752a156.923 156.923 0 0 1 1.869-8.499c10.486 2.32 22.093 3.988 34.498 4.994c7.084 9.967 14.501 19.128 21.976 27.15a134.668 134.668 0 0 1-4.877 4.492c-9.933 8.682-19.886 14.842-28.658 17.94ZM50.35 144.747c-12.483-4.267-22.792-9.812-29.858-15.863c-6.35-5.437-9.555-10.836-9.555-15.216c0-9.322 13.897-21.212 37.076-29.293c2.813-.98 5.757-1.905 8.812-2.773c3.204 10.42 7.406 21.315 12.477 32.332c-5.137 11.18-9.399 22.249-12.634 32.792a134.718 134.718 0 0 1-6.318-1.979Zm12.378-84.26c-4.811-24.587-1.616-43.134 6.425-47.789c8.564-4.958 27.502 2.111 47.463 19.835a144.318 144.318 0 0 1 3.841 3.545c-7.438 7.987-14.787 17.08-21.808 26.988c-12.04 1.116-23.565 2.908-34.161 5.309a160.342 160.342 0 0 1-1.76-7.887Zm110.427 27.268a347.8 347.8 0 0 0-7.785-12.803c8.168 1.033 15.994 2.404 23.343 4.08c-2.206 7.072-4.956 14.465-8.193 22.045a381.151 381.151 0 0 0-7.365-13.322Zm-45.032-43.861c5.044 5.465 10.096 11.566 15.065 18.186a322.04 322.04 0 0 0-30.257-.006c4.974-6.559 10.069-12.652 15.192-18.18ZM82.802 87.83a323.167 323.167 0 0 0-7.227 13.238c-3.184-7.553-5.909-14.98-8.134-22.152c7.304-1.634 15.093-2.97 23.209-3.984a321.524 321.524 0 0 0-7.848 12.897Zm8.081 65.352c-8.385-.936-16.291-2.203-23.593-3.793c2.26-7.3 5.045-14.885 8.298-22.6a321.187 321.187 0 0 0 7.257 13.246c2.594 4.48 5.28 8.868 8.038 13.147Zm37.542 31.03c-5.184-5.592-10.354-11.779-15.403-18.433c4.902.192 9.899.29 14.978.29c5.218 0 10.376-.117 15.453-.343c-4.985 6.774-10.018 12.97-15.028 18.486Zm52.198-57.817c3.422 7.8 6.306 15.345 8.596 22.52c-7.422 1.694-15.436 3.058-23.88 4.071a382.417 382.417 0 0 0 7.859-13.026a347.403 347.403 0 0 0 7.425-13.565Zm-16.898 8.101a358.557 358.557 0 0 1-12.281 19.815a329.4 329.4 0 0 1-23.444.823c-7.967 0-15.716-.248-23.178-.732a310.202 310.202 0 0 1-12.513-19.846h.001a307.41 307.41 0 0 1-10.923-20.627a310.278 310.278 0 0 1 10.89-20.637l-.001.001a307.318 307.318 0 0 1 12.413-19.761c7.613-.576 15.42-.876 23.31-.876H128c7.926 0 15.743.303 23.354.883a329.357 329.357 0 0 1 12.335 19.695a358.489 358.489 0 0 1 11.036 20.54a329.472 329.472 0 0 1-11 20.722Zm22.56-122.124c8.572 4.944 11.906 24.881 6.52 51.026c-.344 1.668-.73 3.367-1.15 5.09c-10.622-2.452-22.155-4.275-34.23-5.408c-7.034-10.017-14.323-19.124-21.64-27.008a160.789 160.789 0 0 1 5.888-5.4c18.9-16.447 36.564-22.941 44.612-18.3ZM128 90.808c12.625 0 22.86 10.235 22.86 22.86s-10.235 22.86-22.86 22.86s-22.86-10.235-22.86-22.86s10.235-22.86 22.86-22.86Z"></path></svg>
</file>

<file path="src/components/layout/Overlay.tsx">
import { X } from "lucide-react"
import { Button } from "@/components/ui/button"
import { cn } from "@/lib/utils"
import type { ReactNode } from "react"

interface OverlayProps {
  isOpen: boolean
  onClose: () => void
  title: string
  children: ReactNode
}

export function Overlay({ isOpen, onClose, title, children }: OverlayProps) {
  return (
    <>
      <div
        className={cn(
          "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
          isOpen ? "block" : "hidden"
        )}
        onClick={onClose}
      />
      <div
        className={cn(
          "fixed inset-y-0 right-0 z-50 h-full w-full border-l border-border bg-background p-0 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out sm:max-w-3xl",
          isOpen ? "translate-x-0" : "translate-x-full"
        )}
      >
        <div className="flex h-full flex-col">
          <div className="flex items-center justify-between border-b border-border px-6 py-4">
            <h2 className="text-lg font-semibold text-foreground">
              {title}
            </h2>
            <Button variant="ghost" size="icon" onClick={onClose} className="h-8 w-8 rounded-full">
              <X className="h-4 w-4" />
            </Button>
          </div>
          <div className="flex-1 overflow-y-auto p-6">
            {children}
          </div>
        </div>
      </div>
    </>
  )
}
</file>

<file path="src/components/ui/badge.tsx">
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"
import { cn } from "@/lib/utils"

const badgeVariants = cva(
  "inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",
  {
    variants: {
      variant: {
        default:
          "border-transparent bg-primary text-primary-foreground hover:bg-primary/80",
        secondary:
          "border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",
        destructive:
          "border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",
        outline: "text-foreground",
        // Custom variants used in MoveMate
        warning: "border-transparent bg-yellow-500/15 text-yellow-500 hover:bg-yellow-500/25",
        success: "border-transparent bg-emerald-500/15 text-emerald-500 hover:bg-emerald-500/25",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

export interface BadgeProps
  extends React.HTMLAttributes<HTMLDivElement>,
    VariantProps<typeof badgeVariants> {}

function Badge({ className, variant, ...props }: BadgeProps) {
  return (
    <div className={cn(badgeVariants({ variant }), className)} {...props} />
  )
}

export { Badge, badgeVariants }
</file>

<file path="src/components/ui/button.tsx">
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"
import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/90",
        destructive:
          "bg-destructive text-destructive-foreground hover:bg-destructive/90",
        outline:
          "border border-input bg-background hover:bg-accent hover:text-accent-foreground",
        secondary:
          "bg-secondary text-secondary-foreground hover:bg-secondary/80",
        ghost: "hover:bg-accent hover:text-accent-foreground",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-10 px-4 py-2",
        sm: "h-9 rounded-md px-3",
        lg: "h-11 rounded-md px-8",
        icon: "h-10 w-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button"
    return (
      <Comp
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    )
  }
)
Button.displayName = "Button"

export { Button, buttonVariants }
</file>

<file path="src/components/ui/card.tsx">
import * as React from "react"
import { cn } from "@/lib/utils"

const Card = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn(
      "rounded-xl border bg-card text-card-foreground shadow-sm",
      className
    )}
    {...props}
  />
))
Card.displayName = "Card"

const CardHeader = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("flex flex-col space-y-1.5 p-6", className)}
    {...props}
  />
))
CardHeader.displayName = "CardHeader"

const CardTitle = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLHeadingElement>
>(({ className, ...props }, ref) => (
  <h3
    ref={ref}
    className={cn(
      "font-semibold leading-none tracking-tight",
      className
    )}
    {...props}
  />
))
CardTitle.displayName = "CardTitle"

const CardDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => (
  <p
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
CardDescription.displayName = "CardDescription"

const CardContent = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />
))
CardContent.displayName = "CardContent"

const CardFooter = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("flex items-center p-6 pt-0", className)}
    {...props}
  />
))
CardFooter.displayName = "CardFooter"

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }
</file>

<file path="src/components/ui/input.tsx">
import * as React from "react"
import { cn } from "@/lib/utils"

const Input = React.forwardRef<HTMLInputElement, React.ComponentProps<"input">>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          "flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
          className
        )}
        ref={ref}
        {...props}
      />
    )
  }
)
Input.displayName = "Input"

export { Input }
</file>

<file path="src/features/bounty/BountyList.tsx">
import { useState } from "react";
import { useSuiClientQuery, useCurrentAccount, useSignAndExecuteTransaction } from "@mysten/dapp-kit";
import { Transaction } from "@mysten/sui/transactions";
import { Card, CardContent, CardHeader, CardTitle, CardFooter } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Loader2, Box, CheckCircle, Code, ExternalLink, User, Trophy } from "lucide-react";

function BountyItem({ event, packageId, moduleName }: any) {
  const json = event.parsedJson;
  const account = useCurrentAccount();
  const { mutate: signAndExecuteTransaction } = useSignAndExecuteTransaction();
  
  const [solutionLink, setSolutionLink] = useState("");
  const [isProcessing, setIsProcessing] = useState(false);

  // Fetch Live Data
  const { data: objectData, isLoading } = useSuiClientQuery('getObject', {
    id: json.bounty_id,
    options: { showContent: true }
  });

  if (isLoading) return <div className="p-4"><Loader2 className="animate-spin text-slate-500"/></div>;
  if (!objectData?.data) return null; // Dacă nu s-a încărcat, nu afișăm nimic încă

  // Accesăm câmpurile în siguranță
  const content = objectData.data.content as any;
  const fields = content?.fields;

  if (!fields) return null; // Protecție extra

  const submissions = fields.submissions || [];
  const isCompleted = fields.is_completed;
  const isCreator = account?.address === fields.creator;

  const handleSubmit = () => {
    if (!solutionLink) return alert("Adaugă un link!");
    setIsProcessing(true);
    const txb = new Transaction();
    txb.moveCall({
      target: `${packageId}::${moduleName}::submit_solution`,
      arguments: [txb.object(json.bounty_id), txb.pure.string(solutionLink)]
    });
    signAndExecuteTransaction({ transaction: txb }, {
      onSuccess: () => { alert("Soluție adăugată!"); setSolutionLink(""); setIsProcessing(false); },
      onError: (e) => { console.error(e); setIsProcessing(false); }
    });
  };

  const handleApprove = (index: number) => {
    if(!confirm("Ești sigur că vrei să premiezi această soluție?")) return;
    setIsProcessing(true);
    const txb = new Transaction();
    txb.moveCall({
      target: `${packageId}::${moduleName}::approve_and_pay`,
      arguments: [
        txb.object(json.bounty_id),
        txb.pure.u64(index)
      ]
    });
    signAndExecuteTransaction({ transaction: txb }, {
      onSuccess: () => { alert("Plătit!"); setIsProcessing(false); },
      onError: (e) => { console.error(e); setIsProcessing(false); }
    });
  };

  return (
    <Card className={`border-slate-700 flex flex-col justify-between transition-all ${isCompleted ? 'bg-slate-900/20 opacity-70' : 'bg-slate-900/40'}`}>
      <CardHeader className="pb-2">
        <div className="flex justify-between items-start">
          <Badge variant={isCompleted ? "secondary" : "default"} className={isCompleted ? "bg-emerald-500/10 text-emerald-400" : "bg-blue-500/10 text-blue-400"}>
            {isCompleted ? "COMPLETED" : "OPEN"}
          </Badge>
          <div className="flex items-center text-emerald-400 font-mono text-sm font-bold">
            {/* Folosim ?. și || 0 pentru a preveni crash-ul la matematică */}
            {((parseInt(json.reward_amount || "0") / 1_000_000_000).toFixed(1))} SUI
          </div>
        </div>
        <CardTitle className="text-white text-base mt-2">{json.description}</CardTitle>
      </CardHeader>
      
      <CardContent className="space-y-4">
        <div className="text-xs flex items-center text-slate-400 bg-slate-950 px-2 py-1 rounded border border-slate-800 w-fit">
           <Box className="w-3 h-3 mr-1"/> 
           Creator: {isCreator ? <span className="text-yellow-400 font-bold ml-1">(TU)</span> : (json.creator?.slice(0, 6) + "...")}
        </div>

        {/* --- LISTA DE SOLUȚII (FIXED) --- */}
        <div className="space-y-2 mt-4">
            <h4 className="text-xs text-slate-500 font-bold uppercase">Soluții ({submissions.length})</h4>
            
            {submissions.length === 0 && <p className="text-xs text-slate-600 italic">Încă nicio soluție.</p>}

            {submissions.map((subItem: any, idx: number) => {
                // FIX CRITIC: Uneori datele vin în `subItem.fields`, alteori direct în `subItem`
                // Această linie le normalizează
                const sub = subItem.fields || subItem;

                const isWinner = fields.winner && fields.winner === sub.solver;
                
                return (
                    <div key={idx} className={`p-3 rounded border text-sm flex flex-col gap-2 ${isWinner ? 'border-emerald-500/50 bg-emerald-900/10' : 'border-slate-800 bg-slate-950'}`}>
                        <div className="flex justify-between items-center">
                            <div className="flex items-center gap-2 text-slate-300">
                                <User className="w-3 h-3"/> 
                                {/* AICI CRĂPA: Am adăugat optional chaining (?.) */}
                                <span className="font-mono text-xs">{sub.solver?.slice(0,6)}...</span>
                                {isWinner && <Badge className="h-4 text-[10px] bg-emerald-500 text-black px-1"><Trophy className="w-3 h-3 mr-1"/> WINNER</Badge>}
                            </div>
                            <a href={sub.link} target="_blank" rel="noreferrer" className="text-blue-400 hover:text-blue-300 flex items-center text-xs">
                                <ExternalLink className="w-3 h-3 mr-1"/> Vezi Cod
                            </a>
                        </div>

                        {isCreator && !isCompleted && (
                            <Button 
                                size="sm" 
                                className="w-full bg-emerald-600/80 hover:bg-emerald-600 h-7 text-xs mt-1"
                                onClick={() => handleApprove(idx)}
                                disabled={isProcessing}
                            >
                                <CheckCircle className="w-3 h-3 mr-1"/> Premiază această soluție
                            </Button>
                        )}
                    </div>
                )
            })}
        </div>

      </CardContent>

      <CardFooter className="pt-2 border-t border-slate-800/50">
        {!isCreator && !isCompleted && (
           <div className="w-full flex gap-2">
             <Input 
               placeholder="Link soluție..." 
               className="bg-slate-950 border-slate-700 h-9 text-xs text-white placeholder:text-slate-500"
               value={solutionLink}
               onChange={(e) => setSolutionLink(e.target.value)}
             />
             <Button 
               size="sm" 
               className="bg-blue-600 hover:bg-blue-700"
               onClick={handleSubmit}
               disabled={isProcessing}
             >
               {isProcessing ? <Loader2 className="animate-spin"/> : <Code className="w-4 h-4"/>}
             </Button>
           </div>
        )}
      </CardFooter>
    </Card>
  );
}

export function BountyList({ packageId, moduleName }: { packageId: string, moduleName: string }) {
  const { data: events, isPending, error } = useSuiClientQuery('queryEvents', {
    query: { MoveModule: { package: packageId, module: moduleName } },
    order: "descending"
  });

  if (isPending) return <div className="flex justify-center p-4"><Loader2 className="animate-spin text-blue-500" /></div>;
  if (error) return <div className="text-red-400">Eroare: {error.message}</div>;
  if (!events || events.data.length === 0) return <div className="text-slate-500 text-center">Niciun bounty activ.</div>;

  return (
    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-8">
      {events.data.map((event: any) => (
        <BountyItem key={event.id.txDigest} event={event} packageId={packageId} moduleName={moduleName} />
      ))}
    </div>
  );
}
</file>

<file path="src/features/bounty/BountyView.tsx">
import { useState } from "react"
import { useCurrentAccount, useSignAndExecuteTransaction } from "@mysten/dapp-kit" // <-- NUME NOU
import { Transaction } from "@mysten/sui/transactions";
import { Button } from "@/components/ui/button"
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card"
import { Input } from "@/components/ui/input"
import { Loader2 } from "lucide-react"
import { BountyList } from "./BountyList";

// --- CONSTANTELE TALE ---
const PACKAGE_ID = "0x79ced3a91d839298bd1c052cfbbf454cc103c5d80d8b3607dd7480fe721fb208"; 
const MODULE_NAME = "bounty_board";
// ------------------------

export function BountyView() {
  const account = useCurrentAccount();
  // 1. Hook-ul are acum un nume mai scurt
  const { mutate: signAndExecuteTransaction } = useSignAndExecuteTransaction();
  
  const [bountyDesc, setBountyDesc] = useState("");
  const [amount, setAmount] = useState("0.1"); 
  const [isLoading, setIsLoading] = useState(false);

  const createBounty = () => {
    if (!account) return alert("Conectează wallet-ul!");

    setIsLoading(true);
    
    try {
        const txb = new Transaction();
        
        const amountInMist = parseFloat(amount) * 1_000_000_000;

        const [coin] = txb.splitCoins(txb.gas, [amountInMist]);

        txb.moveCall({
          target: `${PACKAGE_ID}::${MODULE_NAME}::create_bounty`,
          arguments: [
            coin,                   
            txb.pure.string(bountyDesc),
          ],
        });

        // 3. Execute - AICI ESTE SCHIMBAREA CHEIE
        // Parametrul se numește acum 'transaction', nu 'transactionBlock'
        signAndExecuteTransaction(
          { transaction: txb }, 
          {
            onSuccess: (result) => {
              console.log("Bounty Created!", result);
              setIsLoading(false);
              alert(`Succes! Bounty creat. Digest: ${result.digest}`);
              setBountyDesc(""); 
            },
            onError: (err) => {
              console.error("Transaction failed:", err);
              setIsLoading(false);
              alert("Eroare la tranzacție (vezi consola).");
            }
          }
        );
    } catch (e) {
        console.error(e);
        setIsLoading(false);
        alert("Eroare internă.");
    }
  };

  return (
    <div className="space-y-8">
      {/* --- PARTEA DE SUS (FORMULARUL EXISTENT) --- */}
      <Card className="bg-slate-900/50 border-slate-800">
        <CardHeader>
          <CardTitle className="text-lg text-white">Postează o problemă (Escrow)</CardTitle>
        </CardHeader>
        <CardContent className="space-y-4">
          <div>
            <label className="text-xs text-slate-400">Descriere Problemă</label>
            <Input 
              placeholder="Ex: Funcția mint dă eroare..." 
              value={bountyDesc}
              onChange={(e) => setBountyDesc(e.target.value)}
              className="bg-slate-950 border-slate-700 text-white mt-2"
            />
          </div>
          <div>
            <label className="text-xs text-slate-400">Recompensă (SUI)</label>
            <Input 
              type="number" 
              value={amount}
              onChange={(e) => setAmount(e.target.value)}
              className="bg-slate-950 border-slate-700 text-white mt-2"
            />
          </div>
        </CardContent>
      </Card>

      <div className="flex justify-center">
        {!account ? (
          <div className="text-amber-500 text-sm border border-amber-900/50 bg-amber-900/20 px-4 py-2 rounded">
            Conectează Wallet-ul din colțul dreapta-sus pentru a continua
          </div>
        ) : (
          <Button 
            size="lg" 
            className="bg-blue-600 hover:bg-blue-700 text-white min-w-[200px]"
            onClick={createBounty}
            disabled={isLoading || !bountyDesc}
          >
            {isLoading ? <Loader2 className="animate-spin mr-2" /> : "Blocează Fonduri & Creează"}
          </Button>
        )}
      </div>

      {/* --- SECȚIUNEA NOUĂ: LISTA DE BOUNTY-URI --- */}
      <div className="pt-8 border-t border-slate-800">
        <h3 className="text-xl font-bold text-white mb-4 flex items-center">
          <span className="bg-blue-500 w-2 h-2 rounded-full mr-3 animate-pulse"></span>
          Bounties Active pe Blockchain
        </h3>
        {/* Aici montăm "Antena" care ascultă evenimentele */}
        <BountyList packageId={PACKAGE_ID} moduleName={MODULE_NAME} />
      </div>
      {/* ------------------------------------------- */}

    </div>
  )
}
</file>

<file path="src/features/chat/ChatView.tsx">
import { useState, useRef, useEffect } from "react"
// AM SCOS 'Bot' și 'User' din import pentru că nu erau folosite
import { ArrowUpRight, Loader2 } from "lucide-react" 
import { Button } from "@/components/ui/button"
import { Input } from "@/components/ui/input"
import { askMoveMate } from "@/lib/API" 
import ReactMarkdown from "react-markdown"

interface Message {
  role: 'user' | 'ai';
  content: string;
}

export function ChatView() {
  // --- STATE ---
  const [messages, setMessages] = useState<Message[]>([]);
  const [input, setInput] = useState("");
  const [isLoading, setIsLoading] = useState(false);
  
  // Referință pentru autoscroll
  const messagesEndRef = useRef<HTMLDivElement>(null);

  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
  };

  useEffect(() => {
    scrollToBottom();
  }, [messages, isLoading]);

  // --- LOGICA DE TRIMITERE ---
  const handleSend = async () => {
    if (!input.trim()) return;

    const userMessage = input;
    setInput(""); 
    
    setMessages(prev => [...prev, { role: 'user', content: userMessage }]);
    setIsLoading(true);

    const answer = await askMoveMate(userMessage);

    setMessages(prev => [...prev, { role: 'ai', content: answer }]);
    setIsLoading(false);
  };

  const handleKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter') {
      handleSend();
    }
  };

  return (
    <div className="flex flex-col h-[70vh]">
      {/* ZONA DE MESAJE */}
      <div className="flex-1 space-y-6 pr-2 mb-4 overflow-y-auto custom-scrollbar">
        
        {messages.length === 0 && (
          <div className="flex justify-start animate-in fade-in slide-in-from-bottom-4">
            <div className="max-w-[85%] rounded-2xl rounded-tl-sm bg-slate-800/80 border border-slate-700 p-4 text-sm text-slate-300 shadow-sm">
              <p>Salut! Sunt <strong>MoveMate</strong>.</p>
              <p className="mt-2">Am acces indexat la:</p>
              <ul className="list-disc list-inside mt-1 text-slate-400 space-y-1">
                <li>Sui Framework Docs</li>
                <li>Move Book (2024)</li>
              </ul>
              <p className="mt-4 text-xs text-slate-500">Întreabă-mă orice despre smart contracts.</p>
            </div>
          </div>
        )}

        {messages.map((msg, idx) => (
          <div key={idx} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>
            <div 
              className={`
                max-w-[85%] rounded-2xl p-4 text-sm shadow-sm
                ${msg.role === 'user' 
                  ? 'rounded-tr-sm bg-blue-600 text-white shadow-blue-900/20' 
                  : 'rounded-tl-sm bg-slate-800/80 border border-slate-700 text-slate-300'
                }
              `}
            >
              {msg.role === 'ai' ? (
                <ReactMarkdown 
                  components={{
                    // AM SCOS 'node' din parametri și variabila 'match' pentru că nu erau folosite
                    code({className, children, ...props}) {
                      return !className ? (
                        <code className="bg-slate-700 px-1 py-0.5 rounded text-blue-200" {...props}>
                          {children}
                        </code>
                      ) : (
                        <div className="mt-3 rounded-lg bg-[#0d1117] border border-slate-700 p-3 font-mono text-xs text-blue-300 overflow-x-auto my-2">
                          <code className={className} {...props}>
                            {children}
                          </code>
                        </div>
                      )
                    }
                  }}
                >
                  {msg.content}
                </ReactMarkdown>
              ) : (
                <p>{msg.content}</p>
              )}
            </div>
          </div>
        ))}

        {isLoading && (
          <div className="flex justify-start">
            <div className="rounded-2xl rounded-tl-sm bg-slate-800/50 border border-slate-700/50 p-4 text-sm text-slate-400 flex items-center gap-2">
              <Loader2 className="h-4 w-4 animate-spin text-blue-500" />
              <span>MoveMate scrie...</span>
            </div>
          </div>
        )}
        
        <div ref={messagesEndRef} />
      </div>

      {/* ZONA DE INPUT */}
      <div className="pt-4 border-t border-slate-800 mt-auto">
        <div className="relative">
          <Input 
            placeholder="Întreabă despre Move..." 
            className="pr-12 bg-slate-900 border-slate-700 focus-visible:ring-blue-500 h-12 text-slate-200"
            value={input}
            onChange={(e) => setInput(e.target.value)}
            onKeyDown={handleKeyDown}
            disabled={isLoading}
          />
          <Button 
            size="icon" 
            className="absolute right-1 top-1 bottom-1 w-10 h-10 bg-transparent text-blue-500 hover:text-white hover:bg-blue-600 rounded transition-colors"
            onClick={handleSend}
            disabled={isLoading || !input.trim()}
          >
            <ArrowUpRight className="h-5 w-5" />
          </Button>
        </div>
      </div>
    </div>
  )
}
</file>

<file path="src/features/gas/GasView.tsx">
import { Terminal, Layers } from "lucide-react"
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card"
import { Button } from "@/components/ui/button"
import { BarChart, Bar, XAxis, YAxis, Tooltip, ResponsiveContainer, CartesianGrid } from 'recharts'

export function GasView() {
  const data = [
    { name: 'Mint', serial: 4000, parallel: 2400 },
    { name: 'Transfer', serial: 3000, parallel: 1398 },
    { name: 'Swap', serial: 2000, parallel: 9800 },
  ]

  return (
    <div className="space-y-8">
      <Card className="bg-slate-900/50">
        <CardHeader className="flex flex-row items-center justify-between pb-2">
          <CardTitle className="text-lg font-semibold text-white flex items-center">
            <Terminal className="mr-2 h-4 w-4 text-yellow-400" /> 
            Cost Gaz vs. Paralelizare
          </CardTitle>
          <div className="flex space-x-4 text-xs">
            <span className="flex items-center text-slate-400">
              <span className="w-2 h-2 bg-blue-500 rounded-full mr-2" /> Serial
            </span>
            <span className="flex items-center text-slate-400">
              <span className="w-2 h-2 bg-emerald-500 rounded-full mr-2" /> Paralel
            </span>
          </div>
        </CardHeader>
        
        <CardContent>
          <div className="h-64 w-full">
            <ResponsiveContainer width="100%" height="100%">
              <BarChart data={data} barGap={0}>
                <CartesianGrid strokeDasharray="3 3" stroke="#1e293b" vertical={false} />
                <XAxis dataKey="name" stroke="#64748b" fontSize={12} tickLine={false} axisLine={false} dy={10} />
                <YAxis stroke="#64748b" fontSize={12} tickLine={false} axisLine={false} />
                <Tooltip 
                  cursor={{ fill: 'rgba(255,255,255,0.05)' }}
                  contentStyle={{ backgroundColor: '#0f172a', borderColor: '#334155', color: '#fff', borderRadius: '8px' }}
                />
                <Bar dataKey="serial" fill="#3b82f6" radius={[4, 4, 0, 0]} barSize={20} />
                <Bar dataKey="parallel" fill="#10b981" radius={[4, 4, 0, 0]} barSize={20} />
              </BarChart>
            </ResponsiveContainer>
          </div>
        </CardContent>
      </Card>

      <div className="space-y-4">
        <h4 className="text-sm font-semibold text-slate-400 uppercase tracking-wider">Detecție Contenție Obiecte</h4>
        
        <div className="bg-slate-900/30 rounded-lg p-4 border border-slate-800 flex items-start space-x-4 hover:border-slate-600 transition-colors">
          <div className="p-2 bg-red-900/20 rounded text-red-400 mt-1">
            <Layers size={18} />
          </div>
          <div>
            <h5 className="text-sm font-medium text-white">Hotspot: Shared Object 0x4a...9f</h5>
            <p className="text-xs text-slate-400 mt-1">Acest obiect este accesat mutabil de 85% din tranzacții, blocând paralelizarea.</p>
            <div className="mt-3 flex gap-2">
               <Button size="sm" variant="outline" className="h-7 text-xs border-slate-700">Analizează Obiect</Button>
               <Button size="sm" className="h-7 text-xs bg-blue-600/20 text-blue-400 hover:bg-blue-600/30 border-transparent">Sugestie Sharding</Button>
            </div>
          </div>
        </div>
      </div>
    </div>
  )
}
</file>

<file path="src/features/scanner/ScannerView.tsx">
import { FileCode, AlertTriangle } from "lucide-react"
import { Button } from "@/components/ui/button"
import { Badge } from "@/components/ui/badge"
import { Card, CardContent } from "@/components/ui/card"

export function ScannerView() {
  return (
    <div className="space-y-8">
      {/* Upload Area */}
      <div className="rounded-xl border border-dashed border-slate-700 bg-slate-900/30 p-12 text-center hover:bg-slate-900/50 hover:border-blue-500/50 transition-all cursor-pointer group">
        <div className="w-16 h-16 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform shadow-lg">
          <FileCode className="h-8 w-8 text-slate-400 group-hover:text-blue-400 transition-colors" />
        </div>
        <h3 className="text-lg font-semibold text-white">Upload fișier .move</h3>
        <p className="text-slate-500 text-sm mt-2">Sau trage fișierele aici. Suportă multiple module.</p>
        <Button variant="outline" className="mt-6">Selectează din Computer</Button>
      </div>

      {/* Results List */}
      <div className="space-y-4">
        <div className="flex items-center justify-between pb-2 border-b border-slate-800">
          <h3 className="text-sm font-semibold text-slate-300 flex items-center">
            <AlertTriangle className="w-4 h-4 mr-2 text-yellow-500" />
            Rezultate Scanare Anterioară
          </h3>
          <div className="flex space-x-2">
            <Badge variant="destructive">2 Critice</Badge>
            <Badge variant="warning">1 Medie</Badge>
          </div>
        </div>

        {/* Vulnerability Card */}
        <Card className="border-l-4 border-l-red-500 bg-slate-900/40 overflow-hidden">
          <div className="p-4 bg-red-500/5 border-b border-slate-800">
            <div className="flex justify-between items-start mb-2">
              <span className="text-red-400 font-mono text-xs font-bold px-2 py-0.5 bg-red-500/10 rounded">CRITICAL-001</span>
              <span className="text-slate-500 text-xs font-mono">my_coin.move:41</span>
            </div>
            <h4 className="font-semibold text-slate-200">Lipsă Verificare Ownership</h4>
            <p className="text-slate-400 text-sm mt-1">Funcția `mint` permite oricui să creeze monede fără a verifica `TreasuryCap`.</p>
          </div>
          
          <div className="bg-[#0d1117] p-4 font-mono text-xs overflow-x-auto">
            <div className="text-slate-600 select-none">40 |     // ...</div>
            <div className="text-red-400/50 bg-red-900/10 -mx-4 px-4 py-1 block">
              - public fun mint(amount: u64, ctx: &mut TxContext)
            </div>
            <div className="text-emerald-400/50 bg-emerald-900/10 -mx-4 px-4 py-1 block">
              + public fun mint(cap: &mut TreasuryCap, amount: u64, ctx: &mut TxContext)
            </div>
          </div>
          
          <CardContent className="p-3 bg-slate-950/50 border-t border-slate-800 flex justify-end space-x-3">
            <Button size="sm" variant="ghost">Ignoră</Button>
            <Button size="sm">Aplică Fix Automat</Button>
          </CardContent>
        </Card>
      </div>
    </div>
  )
}
</file>

<file path="src/features/txlab/TxLabView.tsx">
/**
 * MoveCall Sandbox / TxLab
 * 
 * This component allows users to:
 * - Load Move package ABI from chain (modules + entry functions + parameters)
 * - Select module/function, enter args + type args
 * - Simulate (devInspectTransactionBlock) WITHOUT wallet popup
 * - Execute (useSignAndExecuteTransaction) WITH wallet popup
 * - Display results: status, error, gas used, effects/events/object changes JSON
 * 
 * MVP TEST PRESET:
 * Click "Send 0.001 SUI to myself (simulate)" button to autofill:
 * - packageId = "0x2"
 * - module = "pay"
 * - function = "split_and_transfer"
 * - typeArguments = ["0x2::sui::SUI"]
 * - args: c = Use Gas Coin, amount = 1000000, recipient = account.address
 * 
 * This matches Sui framework docs for testing coin transfers.
 */

import { useState, useEffect } from "react"
import { useSuiClient, useCurrentAccount, useSignAndExecuteTransaction } from "@mysten/dapp-kit"
import { Transaction } from "@mysten/sui/transactions"
import { Button } from "@/components/ui/button"
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card"
import { Input } from "@/components/ui/input"
import { Badge } from "@/components/ui/badge"
import { Loader2, Info } from "lucide-react"

// Quick fill package IDs
const QUICK_FILL_PACKAGES = [
  { name: "Bounty Protocol", id: "0x79ced3a91d839298bd1c052cfbbf454cc103c5d80d8b3607dd7480fe721fb208" },
  // Add more known packages here
]

// Sui normalized Move type (can be string or structured object)
type SuiMoveNormalizedType =
  | string
  | { Vector: SuiMoveNormalizedType }
  | { Struct: { address: string; module: string; name: string; typeArguments: SuiMoveNormalizedType[] } }
  | { Reference: SuiMoveNormalizedType }
  | { MutableReference: SuiMoveNormalizedType }
  | { TypeParameter: number }

// Recursively convert Sui normalized Move type to string
const moveTypeToString = (t: SuiMoveNormalizedType | unknown): string => {
  if (typeof t === "string") {
    return t
  }
  if (t && typeof t === "object") {
    if ("Vector" in t) {
      return `vector<${moveTypeToString((t as { Vector: SuiMoveNormalizedType }).Vector)}>`
    }
    if ("Struct" in t) {
      const struct = (t as { Struct: { address: string; module: string; name: string; typeArguments: SuiMoveNormalizedType[] } }).Struct
      const typeArgs = struct.typeArguments.length > 0
        ? `<${struct.typeArguments.map(moveTypeToString).join(", ")}>`
        : ""
      return `${struct.address}::${struct.module}::${struct.name}${typeArgs}`
    }
    if ("Reference" in t) {
      return `&${moveTypeToString((t as { Reference: SuiMoveNormalizedType }).Reference)}`
    }
    if ("MutableReference" in t) {
      return `&mut ${moveTypeToString((t as { MutableReference: SuiMoveNormalizedType }).MutableReference)}`
    }
    if ("TypeParameter" in t) {
      return `T${(t as { TypeParameter: number }).TypeParameter}`
    }
  }
  // Fallback for unexpected shapes
  try {
    return JSON.stringify(t)
  } catch {
    return String(t)
  }
}

type NormalizedMoveFunction = {
  name: string
  visibility: string
  isEntry: boolean
  typeParameters: any[]
  parameters: SuiMoveNormalizedType[]
  return: string[] | null
}

type ExposedFunctionsRaw =
  | Record<string, Omit<NormalizedMoveFunction, "name">>
  | NormalizedMoveFunction[]
  | null
  | undefined

type NormalizedMoveModule = {
  fileFormatVersion: string
  address: string
  name: string
  friends: string[]
  structs: any[]
  exposedFunctions: ExposedFunctionsRaw
}

type NormalizedMoveModules = Record<string, NormalizedMoveModule>

type ArgInputMode = "auto" | "value" | "gas-coin" | "object" | "bcs-bytes"

type ArgInput = {
  value: string
  mode: ArgInputMode
}

type ParamClassification = {
  kind: "coin" | "pure" | "vector" | "option" | "object" | "unknownPureBytes"
  innerType?: string
  pureType?: "bool" | "u8" | "u16" | "u32" | "u64" | "u128" | "u256" | "address" | "string" | "id"
}

export function TxLabView() {
  const client = useSuiClient()
  const account = useCurrentAccount()
  const { mutate: signAndExecuteTransaction } = useSignAndExecuteTransaction()

  const [packageId, setPackageId] = useState("")
  const [modules, setModules] = useState<NormalizedMoveModules | null>(null)
  const [selectedModule, setSelectedModule] = useState<string>("")
  const [selectedFunction, setSelectedFunction] = useState<string>("")
  const [typeArguments, setTypeArguments] = useState<string>("")
  const [argInputs, setArgInputs] = useState<Record<number, ArgInput>>({})
  const [isLoadingABI, setIsLoadingABI] = useState(false)
  const [isLoadingDevInspect, setIsLoadingDevInspect] = useState(false)
  const [isLoadingExecute, setIsLoadingExecute] = useState(false)
  const [result, setResult] = useState<any>(null)
  const [error, setError] = useState<string | null>(null)
  const [devInspectSkipChecks, setDevInspectSkipChecks] = useState(false)
  const [devInspectGasBudgetMist, setDevInspectGasBudgetMist] = useState<string>("")
  const [showAdvancedOptions, setShowAdvancedOptions] = useState(false)

  // Auto-select first module with entry functions after ABI load
  useEffect(() => {
    if (modules && !selectedModule && Object.keys(modules).length > 0) {
      const withEntry = Object.keys(modules).find((m) =>
        normalizeExposedFunctionsFrom(modules, m).some((fn) => fn.isEntry)
      )
      setSelectedModule(withEntry ?? Object.keys(modules)[0])
    }
  }, [modules, selectedModule])

  // Auto-select first entry function when module is selected (only if not already set)
  useEffect(() => {
    if (selectedModule && !selectedFunction && modules) {
      const entryFunctions = normalizeExposedFunctions(selectedModule).filter((fn) => fn.isEntry === true)
      if (entryFunctions.length > 0) {
        setSelectedFunction(entryFunctions[0].name)
      }
    }
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [selectedModule, modules])

  // Pure helper that works with any modules object (not just state)
  const normalizeExposedFunctionsFrom = (all: NormalizedMoveModules | null, moduleName: string): NormalizedMoveFunction[] => {
    if (!all) return []
    const mod = all[moduleName]
    if (!mod) return []
    const raw = mod.exposedFunctions as ExposedFunctionsRaw
    if (Array.isArray(raw)) {
      return raw.filter(Boolean) as NormalizedMoveFunction[]
    }
    if (raw && typeof raw === "object") {
      return Object.entries(raw).map(([name, def]) => ({
        name,
        ...(def as Omit<NormalizedMoveFunction, "name">),
      }))
    }
    return []
  }

  // Wrapper that uses current modules state
  const normalizeExposedFunctions = (moduleName: string): NormalizedMoveFunction[] => {
    return normalizeExposedFunctionsFrom(modules, moduleName)
  }

  const loadModules = async () => {
    if (!packageId.trim()) {
      setError("Please enter a package ID")
      return
    }

    setIsLoadingABI(true)
    setError(null)
    setModules(null)
    setResult(null)

    try {
      const normalizedModules = await client.getNormalizedMoveModulesByPackage({
        package: packageId.trim(),
      })
      setModules(normalizedModules as unknown as NormalizedMoveModules)
      // Explicit reset after ABI load
      setSelectedModule("")
      setSelectedFunction("")
      setArgInputs({})
      setTypeArguments("")
      setResult(null)
      setError(null)
    } catch (err: any) {
      setError(`Failed to load modules: ${err.message || String(err)}`)
      setModules(null)
    } finally {
      setIsLoadingABI(false)
    }
  }

  const getEntryFunctions = (moduleName: string): NormalizedMoveFunction[] => {
    return normalizeExposedFunctions(moduleName).filter((fn) => fn.isEntry === true)
  }

  const getFunctionParams = (moduleName: string, fnName: string): string[] => {
    const fn = normalizeExposedFunctions(moduleName).find((f) => f.name === fnName && f.isEntry)
    if (!fn) return []
    // Convert parameters to strings first, then filter out TxContext
    const params = (fn.parameters ?? []).map(moveTypeToString)
    return params.filter(
      (param) => !param.includes("tx_context::TxContext") && !param.includes("TxContext")
    )
  }

  // Normalize type string (strip leading &mut / &)
  const normalizeType = (typeStr: string): string => {
    return typeStr.replace(/^&mut\s+/, "").replace(/^&\s+/, "")
  }

  // Classify parameter type
  const classifyParam = (typeStr: string): ParamClassification => {
    const normalized = normalizeType(typeStr)

    // Coin type
    if (normalized.includes("coin::Coin<") || normalized.includes("Coin<")) {
      return { kind: "coin" }
    }

    // Pure primitives
    if (normalized === "bool" || normalized === "Bool") {
      return { kind: "pure", pureType: "bool" }
    }
    if (normalized === "u8" || normalized === "U8") {
      return { kind: "pure", pureType: "u8" }
    }
    if (normalized === "u16" || normalized === "U16") {
      return { kind: "pure", pureType: "u16" }
    }
    if (normalized === "u32" || normalized === "U32") {
      return { kind: "pure", pureType: "u32" }
    }
    if (normalized === "u64" || normalized === "U64" || normalized.startsWith("u64")) {
      return { kind: "pure", pureType: "u64" }
    }
    if (normalized === "u128" || normalized === "U128" || normalized.startsWith("u128")) {
      return { kind: "pure", pureType: "u128" }
    }
    if (normalized === "u256" || normalized === "U256" || normalized.startsWith("u256")) {
      return { kind: "pure", pureType: "u256" }
    }
    if (normalized === "address" || normalized === "Address") {
      return { kind: "pure", pureType: "address" }
    }

    // Pure string
    if (normalized === "string" || normalized === "String" || normalized.includes("string::String")) {
      return { kind: "pure", pureType: "string" }
    }

    // Pure ID
    if (normalized === "0x2::object::ID" || normalized.endsWith("::object::ID")) {
      return { kind: "pure", pureType: "id" }
    }

    // Vector
    const vectorMatch = normalized.match(/^vector<(.+)>$/i)
    if (vectorMatch) {
      return { kind: "vector", innerType: vectorMatch[1] }
    }

    // Option
    const optionMatch = normalized.match(/(?:0x1::)?option::Option<(.+)>/i)
    if (optionMatch) {
      return { kind: "option", innerType: optionMatch[1] }
    }

    // Object (default for struct types)
    if (normalized.includes("::") && !normalized.startsWith("std::") && !normalized.startsWith("0x1::")) {
      return { kind: "object" }
    }

    // Fallback: treat as pure (will use string fallback)
    return { kind: "pure", pureType: "string" }
  }


  // Parse vector input (supports JSON array, comma list, or hex for vector<u8>)
  const parseVectorInput = (input: string, innerType: string): any[] => {
    const trimmed = input.trim()
    
    // Try JSON array first
    if (trimmed.startsWith("[") && trimmed.endsWith("]")) {
      try {
        return JSON.parse(trimmed)
      } catch {
        // Fall through to comma parsing
      }
    }

    // For vector<u8>, try hex parsing
    if (innerType === "u8" && trimmed.startsWith("0x")) {
      try {
        const hex = trimmed.slice(2)
        if (hex.length % 2 === 0) {
          const bytes: number[] = []
          for (let i = 0; i < hex.length; i += 2) {
            bytes.push(parseInt(hex.substring(i, i + 2), 16))
          }
          return bytes
        }
      } catch {
        // Fall through
      }
    }

    // Comma-separated list
    if (trimmed.includes(",")) {
      return trimmed.split(",").map(s => s.trim()).filter(s => s.length > 0)
    }

    // Single value
    return trimmed ? [trimmed] : []
  }

  // Parse pure value based on type
  const parsePureValue = (value: string, pureType: ParamClassification["pureType"]): any => {
    const trimmed = value.trim()
    
    switch (pureType) {
      case "bool":
        return trimmed === "true" || trimmed === "1"
      case "u8":
        return Number(trimmed)
      case "u16":
        return Number(trimmed)
      case "u32":
        return Number(trimmed)
      case "u64":
        return BigInt(trimmed)
      case "u128":
        return BigInt(trimmed)
      case "u256":
        return BigInt(trimmed)
      case "address":
        return trimmed
      case "string":
        return trimmed
      case "id":
        return trimmed
      default:
        return trimmed
    }
  }

  const buildTransaction = (): Transaction | null => {
    try {
      if (!selectedModule || !selectedFunction || !packageId) return null
      if (!account) return null

      const params = getFunctionParams(selectedModule, selectedFunction)
      const tx = new Transaction()
      const args: any[] = []

      // Parse type arguments
      const typeArgs = typeArguments
        .split(",")
        .map(t => t.trim())
        .filter(t => t.length > 0)

      params.forEach((paramType, index) => {
        const argInput = argInputs[index] || { value: "", mode: "auto" as ArgInputMode }
        const classification = classifyParam(paramType)
        const mode = argInput.mode === "auto" ? (classification.kind === "coin" ? "gas-coin" : classification.kind === "object" ? "object" : "value") : argInput.mode

        try {
          if (mode === "gas-coin") {
            if (classification.kind !== "coin") {
              throw new Error(`Parameter #${index} is not a Coin type, cannot use gas coin`)
            }
            args.push(tx.gas)
          } else if (mode === "object" || (argInput.mode === "auto" && classification.kind === "object")) {
            if (!argInput.value.trim()) {
              throw new Error(`Missing object ID for parameter #${index} (${paramType})`)
            }
            args.push(tx.object(argInput.value.trim()))
          } else if (mode === "bcs-bytes") {
            let bytes: Uint8Array
            const value = argInput.value.trim()
            if (value.startsWith("0x")) {
              const hex = value.slice(2)
              if (hex.length % 2 !== 0) {
                throw new Error(`Invalid hex string for parameter #${index}`)
              }
              const byteArray: number[] = []
              for (let i = 0; i < hex.length; i += 2) {
                byteArray.push(parseInt(hex.substring(i, i + 2), 16))
              }
              bytes = new Uint8Array(byteArray)
            } else if (value.startsWith("base64:")) {
              const base64 = value.slice(7)
              const binaryString = atob(base64)
              bytes = new Uint8Array(binaryString.length)
              for (let i = 0; i < binaryString.length; i++) {
                bytes[i] = binaryString.charCodeAt(i)
              }
            } else {
              throw new Error(`Invalid BCS bytes format for parameter #${index}. Use 0x... or base64:...`)
            }
            args.push(tx.pure(bytes))
          } else {
            // Pure, vector, or option
            if (!argInput.value.trim() && classification.kind !== "option") {
              throw new Error(`Missing value for parameter #${index} (${paramType})`)
            }

            if (classification.kind === "pure") {
              const parsed = parsePureValue(argInput.value, classification.pureType)
              switch (classification.pureType) {
                case "bool":
                  args.push(tx.pure.bool(parsed))
                  break
                case "u8":
                  args.push(tx.pure.u8(parsed))
                  break
                case "u16":
                  args.push(tx.pure.u16(parsed))
                  break
                case "u32":
                  args.push(tx.pure.u32(parsed))
                  break
                case "u64":
                  args.push(tx.pure.u64(parsed))
                  break
                case "u128":
                  args.push(tx.pure.u128(parsed))
                  break
                case "u256":
                  args.push(tx.pure.u256(parsed))
                  break
                case "address":
                  args.push(tx.pure.address(parsed))
                  break
                case "id":
                  args.push(tx.pure.id(parsed))
                  break
                case "string":
                default:
                  args.push(tx.pure.string(parsed))
                  break
              }
            } else if (classification.kind === "vector" && classification.innerType) {
              const innerClass = classifyParam(classification.innerType)
              const array = parseVectorInput(argInput.value, classification.innerType)
              
              if (innerClass.kind === "pure" && innerClass.pureType) {
                const parsedArray = array.map(v => parsePureValue(String(v), innerClass.pureType))
                switch (innerClass.pureType) {
                  case "u8":
                    args.push(tx.pure.vector("u8", parsedArray))
                    break
                  case "u16":
                    args.push(tx.pure.vector("u16", parsedArray))
                    break
                  case "u32":
                    args.push(tx.pure.vector("u32", parsedArray))
                    break
                  case "u64":
                    args.push(tx.pure.vector("u64", parsedArray))
                    break
                  case "u128":
                    args.push(tx.pure.vector("u128", parsedArray))
                    break
                  case "u256":
                    args.push(tx.pure.vector("u256", parsedArray))
                    break
                  case "address":
                    args.push(tx.pure.vector("address", parsedArray))
                    break
                  case "bool":
                    args.push(tx.pure.vector("bool", parsedArray))
                    break
                  default:
                    args.push(tx.pure.vector("string", parsedArray.map(String)))
                    break
                }
              } else {
                // For non-primitive vectors, fallback to string array
                args.push(tx.pure.vector("string", array.map(String)))
              }
            } else if (classification.kind === "option" && classification.innerType) {
              const value = argInput.value.trim()
              if (!value || value === "null") {
                args.push(tx.pure.option("string", null))
              } else {
                const innerClass = classifyParam(classification.innerType)
                if (innerClass.kind === "pure" && innerClass.pureType) {
                  const parsed = parsePureValue(value, innerClass.pureType)
                  switch (innerClass.pureType) {
                    case "u64":
                      args.push(tx.pure.option("u64", parsed))
                      break
                    case "u128":
                      args.push(tx.pure.option("u128", parsed))
                      break
                    case "address":
                      args.push(tx.pure.option("address", parsed))
                      break
                    default:
                      args.push(tx.pure.option("string", String(parsed)))
                      break
                  }
                } else {
                  args.push(tx.pure.option("string", value))
                }
              }
            } else {
              // Fallback: treat as string
              args.push(tx.pure.string(argInput.value.trim()))
            }
          }
        } catch (err: any) {
          throw new Error(`Parameter #${index} (${paramType}): ${err.message}`)
        }
      })

      tx.moveCall({
        target: `${packageId}::${selectedModule}::${selectedFunction}`,
        arguments: args,
        typeArguments: typeArgs.length > 0 ? typeArgs : undefined,
      })

      return tx
    } catch (err: any) {
      console.error("Error building transaction:", err)
      throw err
    }
  }

  const handleDevInspect = async () => {
    if (!account) {
      setError("Please connect your wallet")
      return
    }

    setIsLoadingDevInspect(true)
    setError(null)
    setResult(null)

    try {
      const tx = buildTransaction()
      if (!tx) {
        throw new Error("Failed to build transaction")
      }

      const additionalArgs: any = {}
      if (devInspectSkipChecks) {
        additionalArgs.skip_checks = true
      }
      if (devInspectGasBudgetMist && devInspectGasBudgetMist.trim()) {
        const budget = BigInt(devInspectGasBudgetMist.trim())
        if (budget > 0n) {
          additionalArgs.gas_budget = budget.toString()
        }
      }

      const response = await client.devInspectTransactionBlock({
        sender: account.address,
        transactionBlock: tx,
        ...(Object.keys(additionalArgs).length > 0 ? { additionalArgs } : {}),
      })

      const gasUsed = response.effects?.gasUsed
      const status = response.effects?.status

      setResult({
        type: "devInspect",
        data: response,
        summary: {
          error: status?.status === "failure" ? (status as any).error || "Execution failed" : null,
          status: status?.status || "unknown",
          gasUsed: gasUsed ? {
            computationCost: gasUsed.computationCost,
            storageCost: gasUsed.storageCost,
            storageRebate: gasUsed.storageRebate,
            total: gasUsed.computationCost ? 
              (BigInt(gasUsed.computationCost) + BigInt(gasUsed.storageCost || "0") - BigInt(gasUsed.storageRebate || "0")).toString() 
              : null,
          } : null,
          eventsCount: response.events?.length || 0,
          events: response.events || [],
          effects: response.effects || null,
        },
      })
    } catch (err: any) {
      setError(`Dev-Inspect failed: ${err.message || String(err)}`)
      setResult({ type: "error", error: err.message || String(err) })
    } finally {
      setIsLoadingDevInspect(false)
    }
  }

  const handleExecute = async () => {
    if (!account) {
      setError("Please connect your wallet")
      return
    }

    setIsLoadingExecute(true)
    setError(null)
    setResult(null)

    try {
      const tx = buildTransaction()
      if (!tx) {
        throw new Error("Failed to build transaction")
      }

      signAndExecuteTransaction(
        {
          transaction: tx,
        },
        {
          onSuccess: async (response) => {
            try {
              // Fetch full transaction details with all options
              const fullTx = await client.getTransactionBlock({
                digest: response.digest,
                options: {
                  showEffects: true,
                  showEvents: true,
                  showObjectChanges: true,
                  showBalanceChanges: true,
                },
              })

              const effects = fullTx.effects
              const gasUsed = effects?.gasUsed
              const status = effects?.status
              setResult({
                type: "execution",
                data: fullTx,
                summary: {
                  digest: response.digest,
                  status: status?.status || (typeof status === "string" ? status : "unknown"),
                  gasUsed: gasUsed ? {
                    computationCost: gasUsed.computationCost,
                    storageCost: gasUsed.storageCost,
                    storageRebate: gasUsed.storageRebate,
                    total: gasUsed.computationCost ? 
                      (BigInt(gasUsed.computationCost) + BigInt(gasUsed.storageCost || "0") - BigInt(gasUsed.storageRebate || "0")).toString() 
                      : null,
                  } : null,
                  eventsCount: fullTx.events?.length || 0,
                  events: fullTx.events || [],
                  effects: effects || null,
                  objectChanges: fullTx.objectChanges || [],
                  balanceChanges: fullTx.balanceChanges || [],
                },
              })
            } catch (fetchErr: any) {
              // Fallback to response if fetch fails
              const effects = (response as any).effects
              const gasUsed = effects?.gasUsed
              const status = effects?.status
              setResult({
                type: "execution",
                data: response,
                summary: {
                  digest: response.digest,
                  status: status?.status || (typeof status === "string" ? status : "unknown"),
                  gasUsed: gasUsed ? {
                    computationCost: gasUsed.computationCost,
                    storageCost: gasUsed.storageCost,
                    storageRebate: gasUsed.storageRebate,
                    total: gasUsed.computationCost ? 
                      (BigInt(gasUsed.computationCost) + BigInt(gasUsed.storageCost || "0") - BigInt(gasUsed.storageRebate || "0")).toString() 
                      : null,
                  } : null,
                  eventsCount: (response as any).events?.length || 0,
                  events: (response as any).events || [],
                  effects: effects || null,
                  objectChanges: (response as any).objectChanges || [],
                  balanceChanges: (response as any).balanceChanges || [],
                },
              })
            }
            setIsLoadingExecute(false)
          },
          onError: (err: any) => {
            setError(`Execution failed: ${err.message || String(err)}`)
            setResult({ type: "error", error: err.message || String(err) })
            setIsLoadingExecute(false)
          },
        }
      )
    } catch (err: any) {
      setError(`Execution failed: ${err.message || String(err)}`)
      setResult({ type: "error", error: err.message || String(err) })
      setIsLoadingExecute(false)
    }
  }

  const applyMvpPreset = async () => {
    if (!account) {
      setError("Please connect your wallet first")
      return
    }

    setPackageId("0x2")
    setTypeArguments("0x2::sui::SUI")
    
    // Load modules for 0x2 package
    setIsLoadingABI(true)
    setError(null)
    try {
      const normalizedModules = await client.getNormalizedMoveModulesByPackage({
        package: "0x2",
      })
      const loadedModules = normalizedModules as unknown as NormalizedMoveModules
      setModules(loadedModules)
      
      // Get params from the loaded module using the pure helper
      const functions = normalizeExposedFunctionsFrom(loadedModules, "pay")
      const fn = functions.find((f) => f.name === "split_and_transfer" && f.isEntry)
      if (fn) {
        // Convert parameters to strings first, then filter out TxContext
        const params = (fn.parameters ?? []).map(moveTypeToString).filter(
          (param) => !param.includes("tx_context::TxContext") && !param.includes("TxContext")
        )
        const newArgInputs: Record<number, ArgInput> = {}
        
        params.forEach((paramType, index) => {
          const classification = classifyParam(paramType)
          if (classification.kind === "coin") {
            // First Coin parameter - use gas coin
            newArgInputs[index] = { value: "", mode: "gas-coin" }
          } else if (paramType.includes("u64")) {
            // Amount parameter
            newArgInputs[index] = { value: "1000000", mode: "auto" }
          } else if (paramType === "address" || paramType === "Address") {
            // Recipient parameter
            newArgInputs[index] = { value: account.address, mode: "auto" }
          } else {
            newArgInputs[index] = { value: "", mode: "auto" }
          }
        })
        
        setArgInputs(newArgInputs)
      }
      
      setSelectedModule("pay")
      setSelectedFunction("split_and_transfer")
    } catch (err: any) {
      setError(`Failed to load preset: ${err.message || String(err)}`)
    } finally {
      setIsLoadingABI(false)
    }
  }

  const entryFunctions = selectedModule ? getEntryFunctions(selectedModule) : []
  const functionParams = selectedModule && selectedFunction ? getFunctionParams(selectedModule, selectedFunction) : []
  const target = packageId && selectedModule && selectedFunction
    ? `${packageId}::${selectedModule}::${selectedFunction}`
    : ""

  const canExecute = account && selectedModule && selectedFunction && functionParams.every((paramType, i) => {
    const argInput = argInputs[i] || { value: "", mode: "auto" as ArgInputMode }
    const classification = classifyParam(paramType)
    const effectiveMode = argInput.mode === "auto" 
      ? (classification.kind === "coin" ? "gas-coin" : classification.kind === "object" ? "object" : "value")
      : argInput.mode
    
    if (effectiveMode === "gas-coin") return true
    if (effectiveMode === "object") return argInput.value.trim().length > 0
    if (classification.kind === "option") return true // Option can be null/empty
    return argInput.value.trim().length > 0
  })

  return (
    <div className="space-y-6">
      {/* How to Use Panel */}
      <Card className="bg-slate-900/50 border-slate-800 border-blue-500/30">
        <CardHeader>
          <CardTitle className="text-lg text-white flex items-center gap-2">
            <Info className="h-5 w-5 text-blue-400" />
            How to Use MoveCall Sandbox
          </CardTitle>
        </CardHeader>
        <CardContent className="space-y-4 text-sm text-slate-300">
          <div className="space-y-3">
            <div>
              <h4 className="font-semibold text-white mb-2">Step-by-Step:</h4>
              <ol className="list-decimal list-inside space-y-1.5 ml-2 text-slate-300">
                <li><strong className="text-white">Connect wallet</strong> (top right) - Required for Dev-Inspect and Execute</li>
                <li><strong className="text-white">Enter Package ID</strong> (or click quick preset button) - The on-chain package address (e.g., <code className="bg-slate-800 px-1 rounded">0x2</code>)</li>
                <li><strong className="text-white">Click "Load Modules"</strong> - Fetches the package ABI from chain</li>
                <li><strong className="text-white">Choose Module + Entry Function</strong> - Select from dropdowns</li>
                <li><strong className="text-white">Fill Type Args</strong> (optional) - Comma-separated fully-qualified types like <code className="bg-slate-800 px-1 rounded">0x2::sui::SUI</code></li>
                <li><strong className="text-white">Fill Arguments:</strong>
                  <ul className="list-disc list-inside ml-4 mt-1 space-y-1">
                    <li><strong className="text-emerald-400">"Use Gas Coin"</strong> - Passes the transaction's gas object as the <code className="bg-slate-800 px-1 rounded">Coin&lt;T&gt;</code> argument</li>
                    <li><strong className="text-blue-400">"Object ID"</strong> - Pass an on-chain object ID (for object parameters)</li>
                    <li><strong className="text-slate-400">"Value"</strong> - Enter a pure value like <code className="bg-slate-800 px-1 rounded">u64</code>, <code className="bg-slate-800 px-1 rounded">address</code>, <code className="bg-slate-800 px-1 rounded">string</code></li>
                  </ul>
                </li>
                <li><strong className="text-white">Press:</strong>
                  <ul className="list-disc list-inside ml-4 mt-1 space-y-1">
                    <li><strong className="text-emerald-400">Dev-Inspect</strong> - Simulation, no wallet popup, no state changes</li>
                    <li><strong className="text-blue-400">Execute</strong> - Real transaction, wallet popup, on-chain execution</li>
                  </ul>
                </li>
              </ol>
            </div>
            
            <div className="pt-2 border-t border-slate-700">
              <h4 className="font-semibold text-white mb-2">MVP Preset:</h4>
              <p className="text-slate-300">
                The <strong className="text-emerald-400">"Send 0.001 SUI to myself (simulate)"</strong> button loads <code className="bg-slate-800 px-1 rounded">0x2::pay::split_and_transfer</code> and sends 0.001 SUI (1,000,000 MIST) to your own address via simulation. Perfect for testing!
              </p>
            </div>

            <div className="pt-2 border-t border-slate-700">
              <h4 className="font-semibold text-white mb-2">Common Pitfalls:</h4>
              <ul className="list-disc list-inside space-y-1 ml-2 text-slate-300">
                <li><strong className="text-amber-400">Wrong network</strong> - App runs on Testnet; <code className="bg-slate-800 px-1 rounded">0x2</code> exists on all networks but your custom packages might not</li>
                <li><strong className="text-amber-400">Missing args / wrong object IDs</strong> - Ensure all required arguments are filled correctly</li>
                <li><strong className="text-amber-400">Type args formatting</strong> - Must be comma-separated fully-qualified types (e.g., <code className="bg-slate-800 px-1 rounded">0x2::sui::SUI, 0x2::coin::Coin</code>)</li>
              </ul>
            </div>
          </div>
        </CardContent>
      </Card>

      {/* Card 1: On-chain ABI Loader */}
      <Card className="bg-slate-900/50 border-slate-800">
        <CardHeader>
          <CardTitle className="text-lg text-white">On-chain ABI Loader</CardTitle>
        </CardHeader>
        <CardContent className="space-y-4">
          <div>
            <label className="text-xs text-slate-400 mb-2 block">Package ID</label>
            <Input
              placeholder="0x..."
              value={packageId}
              onChange={(e) => setPackageId(e.target.value)}
              className="bg-slate-950 border-slate-700 text-white font-mono text-sm"
            />
          </div>
          <div className="flex items-center gap-2 flex-wrap">
            <Button
              onClick={loadModules}
              disabled={isLoadingABI || !packageId.trim()}
              className="bg-blue-600 hover:bg-blue-700 text-white"
            >
              {isLoadingABI ? (
                <>
                  <Loader2 className="animate-spin mr-2 h-4 w-4" />
                  Loading...
                </>
              ) : (
                "Load Modules"
              )}
            </Button>
            <Button
              onClick={applyMvpPreset}
              disabled={isLoadingABI || !account}
              className="bg-emerald-600 hover:bg-emerald-700 text-white"
              title="Autofill: 0x2::pay::split_and_transfer with 0.001 SUI to self"
            >
              Send 0.001 SUI to myself (simulate)
            </Button>
            {QUICK_FILL_PACKAGES.map((pkg) => (
              <Button
                key={pkg.id}
                variant="outline"
                size="sm"
                onClick={() => {
                  setPackageId(pkg.id)
                  setModules(null)
                  setSelectedModule("")
                  setSelectedFunction("")
                  setArgInputs({})
                  setTypeArguments("")
                  setResult(null)
                  setError(null)
                }}
                className="border-slate-700 text-slate-300 hover:bg-slate-800 text-xs"
              >
                {pkg.name}
              </Button>
            ))}
          </div>
          {modules && (
            <div className="mt-2">
              <Badge variant="success" className="text-xs">
                Loaded {Object.keys(modules).length} module(s)
              </Badge>
            </div>
          )}
        </CardContent>
      </Card>

      {/* Card 2: MoveCall Builder */}
      {modules && (
        <Card className="bg-slate-900/50 border-slate-800">
          <CardHeader>
            <CardTitle className="text-lg text-white">MoveCall Builder</CardTitle>
          </CardHeader>
          <CardContent className="space-y-4">
            {/* Module Selection */}
            <div>
              <label className="text-xs text-slate-400 mb-2 block">Module</label>
              <select
                value={selectedModule}
                onChange={(e) => {
                  const newModule = e.target.value
                  setSelectedModule(newModule)
                  // Explicit reset when user manually changes module
                  setSelectedFunction("")
                  setArgInputs({})
                  setTypeArguments("")
                  setResult(null)
                  setError(null)
                }}
                className="w-full h-9 rounded-md border border-slate-700 bg-slate-950 px-3 py-1 text-sm text-white focus:outline-none focus:ring-1 focus:ring-blue-500"
              >
                <option value="">Select module...</option>
                {Object.keys(modules).map((modName) => (
                  <option key={modName} value={modName}>
                    {modName}
                  </option>
                ))}
              </select>
            </div>

            {/* Function Selection */}
            {selectedModule && (
              <div>
                <label className="text-xs text-slate-400 mb-2 block">Entry Function</label>
                <select
                  value={selectedFunction}
                  onChange={(e) => {
                    const newFunction = e.target.value
                    setSelectedFunction(newFunction)
                    // Explicit reset when user manually changes function
                    setArgInputs({})
                    setResult(null)
                    setError(null)
                  }}
                  disabled={entryFunctions.length === 0}
                  className="w-full h-9 rounded-md border border-slate-700 bg-slate-950 px-3 py-1 text-sm text-white focus:outline-none focus:ring-1 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"
                >
                  {entryFunctions.length === 0 ? (
                    <option value="">No entry functions in this module — pick another module</option>
                  ) : (
                    <>
                      <option value="">Select function...</option>
                      {entryFunctions.map((fn) => (
                        <option key={fn.name} value={fn.name}>
                          {fn.name}
                        </option>
                      ))}
                    </>
                  )}
                </select>
                {entryFunctions.length === 0 && (
                  <p className="text-xs text-amber-400 mt-1">
                    This module has no entry functions. Please choose a different module.
                  </p>
                )}
              </div>
            )}

            {/* Type Arguments */}
            {selectedFunction && (
              <div>
                <label className="text-xs text-slate-400 mb-2 block">
                  Type Arguments (comma-separated, e.g., "0x2::sui::SUI")
                </label>
                <Input
                  placeholder="0x2::sui::SUI, 0x2::coin::Coin"
                  value={typeArguments}
                  onChange={(e) => setTypeArguments(e.target.value)}
                  className="bg-slate-950 border-slate-700 text-white font-mono text-sm"
                />
              </div>
            )}

            {/* Function Signature Preview */}
            {selectedFunction && target && (
              <div className="p-3 bg-slate-950/50 border border-slate-800 rounded-md">
                <div className="text-xs text-slate-400 mb-1">Target:</div>
                <div className="text-sm text-blue-400 font-mono break-all">{target}</div>
                {functionParams.length > 0 && (
                  <div className="mt-2">
                    <div className="text-xs text-slate-400 mb-1">Parameters:</div>
                    <div className="space-y-1">
                      {functionParams.map((param, idx) => (
                        <div key={idx} className="text-xs text-slate-300 font-mono">
                          #{idx} — {param}
                        </div>
                      ))}
                    </div>
                  </div>
                )}
              </div>
            )}

            {/* Argument Inputs */}
            {functionParams.length > 0 && (
              <div className="space-y-3">
                <div className="text-xs text-slate-400">Arguments:</div>
                {functionParams.map((paramType, idx) => {
                  const classification = classifyParam(paramType)
                  const argInput = argInputs[idx] || { value: "", mode: "auto" as ArgInputMode }
                  const effectiveMode = argInput.mode === "auto" 
                    ? (classification.kind === "coin" ? "gas-coin" : classification.kind === "object" ? "object" : "value")
                    : argInput.mode

                  const updateArgInput = (updates: Partial<ArgInput>) => {
                    setArgInputs({
                      ...argInputs,
                      [idx]: { ...argInput, ...updates },
                    })
                  }

                  // Classification chip label
                  const chipLabel = classification.kind === "coin" ? "COIN" 
                    : classification.kind === "pure" ? "PURE"
                    : classification.kind === "vector" ? "VECTOR"
                    : classification.kind === "option" ? "OPTION"
                    : classification.kind === "object" ? "OBJECT"
                    : "UNKNOWN"

                  const chipColor = classification.kind === "coin" ? "bg-emerald-500/20 text-emerald-400"
                    : classification.kind === "pure" ? "bg-blue-500/20 text-blue-400"
                    : classification.kind === "vector" ? "bg-purple-500/20 text-purple-400"
                    : classification.kind === "option" ? "bg-yellow-500/20 text-yellow-400"
                    : "bg-slate-500/20 text-slate-400"

                  return (
                    <div key={idx} className="space-y-2">
                      <div className="flex items-center gap-2">
                        <label className="text-xs text-slate-400 mb-1 block">
                          #{idx} — <span className="font-mono text-slate-300">{paramType}</span>
                        </label>
                        <Badge className={`text-[10px] px-1.5 py-0 ${chipColor}`}>
                          {chipLabel}
                        </Badge>
                      </div>
                      
                      {classification.kind === "coin" && (
                        <div className="flex items-center gap-2">
                          <Button
                            type="button"
                            variant={effectiveMode === "gas-coin" ? "default" : "outline"}
                            size="sm"
                            onClick={() => updateArgInput({ mode: "gas-coin", value: "" })}
                            className={effectiveMode === "gas-coin" ? "bg-blue-600" : "border-slate-700"}
                          >
                            Use Gas Coin
                          </Button>
                          <span className="text-xs text-slate-500">or</span>
                          <Button
                            type="button"
                            variant={effectiveMode === "object" ? "default" : "outline"}
                            size="sm"
                            onClick={() => updateArgInput({ mode: "object", value: "" })}
                            className={effectiveMode === "object" ? "bg-blue-600" : "border-slate-700"}
                          >
                            Object ID
                          </Button>
                        </div>
                      )}

                      {classification.kind === "coin" && effectiveMode === "gas-coin" && (
                        <div className="text-xs text-amber-400 bg-amber-900/20 border border-amber-800 px-2 py-1 rounded">
                          ⚠️ Use Gas Coin only works for SUI Coin
                        </div>
                      )}

                      {effectiveMode !== "gas-coin" && (
                        <Input
                          placeholder={
                            effectiveMode === "object" ? "Object ID (0x...)" 
                            : classification.kind === "vector" ? "JSON array [1,2,3] or comma list 1,2,3"
                            : classification.kind === "option" ? "Value or 'null'"
                            : classification.kind === "pure" && classification.pureType === "address" ? "Address (0x...)"
                            : classification.kind === "pure" && classification.pureType === "id" ? "Object ID (0x...)"
                            : "Value"
                          }
                          value={argInput.value}
                          onChange={(e) => updateArgInput({ value: e.target.value })}
                          className="bg-slate-950 border-slate-700 text-white font-mono text-sm"
                        />
                      )}

                      {effectiveMode === "gas-coin" && classification.kind === "coin" && (
                        <div className="text-xs text-emerald-400 bg-emerald-900/20 border border-emerald-800 px-2 py-1 rounded">
                          ✓ Will use transaction gas coin
                        </div>
                      )}

                      {effectiveMode === "object" && classification.kind === "object" && (
                        <div className="text-xs text-blue-400 bg-blue-900/20 border border-blue-800 px-2 py-1 rounded">
                          ℹ️ This is an object argument - enter the object ID
                        </div>
                      )}
                    </div>
                  )
                })}
              </div>
            )}

            {/* Advanced Dev-Inspect Options */}
            {selectedFunction && (
              <div className="border-t border-slate-800 pt-4">
                <Button
                  type="button"
                  variant="ghost"
                  size="sm"
                  onClick={() => setShowAdvancedOptions(!showAdvancedOptions)}
                  className="text-xs text-slate-400 hover:text-slate-300"
                >
                  {showAdvancedOptions ? "▼" : "▶"} Advanced Dev-Inspect Options
                </Button>
                {showAdvancedOptions && (
                  <div className="mt-2 space-y-3 p-3 bg-slate-950/50 border border-slate-800 rounded-md">
                    <div>
                      <label className="text-xs text-slate-400 mb-1 block flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={devInspectSkipChecks}
                          onChange={(e) => setDevInspectSkipChecks(e.target.checked)}
                          className="rounded"
                        />
                        Skip checks
                      </label>
                    </div>
                    <div>
                      <label className="text-xs text-slate-400 mb-1 block">Gas Budget (MIST)</label>
                      <Input
                        type="text"
                        placeholder="Optional (e.g., 10000000)"
                        value={devInspectGasBudgetMist}
                        onChange={(e) => setDevInspectGasBudgetMist(e.target.value)}
                        className="bg-slate-900 border-slate-700 text-white font-mono text-sm"
                      />
                    </div>
                  </div>
                )}
              </div>
            )}

            {/* Action Buttons */}
            <div className="flex gap-3 pt-2">
              <Button
                onClick={handleDevInspect}
                disabled={!canExecute || isLoadingDevInspect || isLoadingExecute}
                className="bg-emerald-600 hover:bg-emerald-700 text-white flex-1"
              >
                {isLoadingDevInspect ? (
                  <>
                    <Loader2 className="animate-spin mr-2 h-4 w-4" />
                    Dev-Inspect...
                  </>
                ) : (
                  "Dev-Inspect"
                )}
              </Button>
              <Button
                onClick={handleExecute}
                disabled={!canExecute || isLoadingDevInspect || isLoadingExecute}
                className="bg-blue-600 hover:bg-blue-700 text-white flex-1"
              >
                {isLoadingExecute ? (
                  <>
                    <Loader2 className="animate-spin mr-2 h-4 w-4" />
                    Executing...
                  </>
                ) : (
                  "Execute"
                )}
              </Button>
            </div>
            {!account && (
              <div className="text-amber-500 text-sm border border-amber-900/50 bg-amber-900/20 px-4 py-2 rounded">
                Connect wallet to use Dev-Inspect or Execute
              </div>
            )}
          </CardContent>
        </Card>
      )}

      {/* Card 3: Result */}
      {(result || error) && (
        <Card className="bg-slate-900/50 border-slate-800">
          <CardHeader>
            <CardTitle className="text-lg text-white">Result</CardTitle>
          </CardHeader>
          <CardContent>
            {error && (
              <div className="mb-4 p-3 bg-red-900/20 border border-red-800 rounded-md">
                <div className="text-sm text-red-400 font-semibold mb-1">Error:</div>
                <div className="text-sm text-red-300">{error}</div>
              </div>
            )}
            {result && result.summary && (
              <div className="mb-4 p-3 bg-slate-950/50 border border-slate-800 rounded-md space-y-2">
                <div className="text-xs text-slate-400 mb-2 font-semibold">Summary:</div>
                {result.type === "devInspect" && (
                  <div className="space-y-1 text-sm">
                    {result.summary.error ? (
                      <div className="text-red-400">❌ Error: {JSON.stringify(result.summary.error)}</div>
                    ) : (
                      <div className="text-green-400">✓ No errors</div>
                    )}
                    <div className="text-slate-300">Status: <span className="font-mono">{result.summary.status}</span></div>
                    {result.summary.gasUsed && (
                      <div className="text-slate-300">
                        Gas Used: {result.summary.gasUsed.total ? `${result.summary.gasUsed.total} MIST` : "N/A"}
                        {result.summary.gasUsed.computationCost && (
                          <span className="text-xs text-slate-500 ml-2">
                            (computation: {result.summary.gasUsed.computationCost}, storage: {result.summary.gasUsed.storageCost || "0"}, rebate: {result.summary.gasUsed.storageRebate || "0"})
                          </span>
                        )}
                      </div>
                    )}
                    <div className="text-slate-300">Events: {result.summary.eventsCount}</div>
                  </div>
                )}
                {result.type === "execution" && (
                  <div className="space-y-1 text-sm">
                    <div className="text-green-400">✓ Transaction executed</div>
                    <div className="text-slate-300 font-mono text-xs break-all">Digest: {result.summary.digest}</div>
                    <div className="text-slate-300">Status: <span className="font-mono">{result.summary.status}</span></div>
                    {result.summary.gasUsed && (
                      <div className="text-slate-300">
                        Gas Used: {result.summary.gasUsed.total ? `${result.summary.gasUsed.total} MIST` : "N/A"}
                        {result.summary.gasUsed.computationCost && (
                          <span className="text-xs text-slate-500 ml-2">
                            (computation: {result.summary.gasUsed.computationCost}, storage: {result.summary.gasUsed.storageCost || "0"}, rebate: {result.summary.gasUsed.storageRebate || "0"})
                          </span>
                        )}
                      </div>
                    )}
                    <div className="text-slate-300">Events: {result.summary.eventsCount}</div>
                    {result.summary.objectChanges && result.summary.objectChanges.length > 0 && (
                      <div className="text-slate-300">Object Changes: {result.summary.objectChanges.length}</div>
                    )}
                    {result.summary.balanceChanges && result.summary.balanceChanges.length > 0 && (
                      <div className="text-slate-300">Balance Changes: {result.summary.balanceChanges.length}</div>
                    )}
                  </div>
                )}
              </div>
            )}
            <div className="bg-slate-950 border border-slate-800 rounded-md p-4 overflow-auto max-h-[500px]">
              <pre className="text-xs text-slate-300 whitespace-pre-wrap break-words">
                {JSON.stringify(result || { error }, null, 2)}
              </pre>
            </div>
          </CardContent>
        </Card>
      )}
    </div>
  )
}
</file>

<file path="src/index.css">
@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme inline {
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

:root {
  --radius: 0.625rem;
  --background: oklch(1 0 0);
  --foreground: oklch(0.145 0 0);
  --card: oklch(1 0 0);
  --card-foreground: oklch(0.145 0 0);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.145 0 0);
  --primary: oklch(0.205 0 0);
  --primary-foreground: oklch(0.985 0 0);
  --secondary: oklch(0.97 0 0);
  --secondary-foreground: oklch(0.205 0 0);
  --muted: oklch(0.97 0 0);
  --muted-foreground: oklch(0.556 0 0);
  --accent: oklch(0.97 0 0);
  --accent-foreground: oklch(0.205 0 0);
  --destructive: oklch(0.577 0.245 27.325);
  --border: oklch(0.922 0 0);
  --input: oklch(0.922 0 0);
  --ring: oklch(0.708 0 0);
  --chart-1: oklch(0.646 0.222 41.116);
  --chart-2: oklch(0.6 0.118 184.704);
  --chart-3: oklch(0.398 0.07 227.392);
  --chart-4: oklch(0.828 0.189 84.429);
  --chart-5: oklch(0.769 0.188 70.08);
  --sidebar: oklch(0.985 0 0);
  --sidebar-foreground: oklch(0.145 0 0);
  --sidebar-primary: oklch(0.205 0 0);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.97 0 0);
  --sidebar-accent-foreground: oklch(0.205 0 0);
  --sidebar-border: oklch(0.922 0 0);
  --sidebar-ring: oklch(0.708 0 0);
}

.dark {
  --background: oklch(0.145 0 0);
  --foreground: oklch(0.985 0 0);
  --card: oklch(0.205 0 0);
  --card-foreground: oklch(0.985 0 0);
  --popover: oklch(0.205 0 0);
  --popover-foreground: oklch(0.985 0 0);
  --primary: oklch(0.922 0 0);
  --primary-foreground: oklch(0.205 0 0);
  --secondary: oklch(0.269 0 0);
  --secondary-foreground: oklch(0.985 0 0);
  --muted: oklch(0.269 0 0);
  --muted-foreground: oklch(0.708 0 0);
  --accent: oklch(0.269 0 0);
  --accent-foreground: oklch(0.985 0 0);
  --destructive: oklch(0.704 0.191 22.216);
  --border: oklch(1 0 0 / 10%);
  --input: oklch(1 0 0 / 15%);
  --ring: oklch(0.556 0 0);
  --chart-1: oklch(0.488 0.243 264.376);
  --chart-2: oklch(0.696 0.17 162.48);
  --chart-3: oklch(0.769 0.188 70.08);
  --chart-4: oklch(0.627 0.265 303.9);
  --chart-5: oklch(0.645 0.246 16.439);
  --sidebar: oklch(0.205 0 0);
  --sidebar-foreground: oklch(0.985 0 0);
  --sidebar-primary: oklch(0.488 0.243 264.376);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.269 0 0);
  --sidebar-accent-foreground: oklch(0.985 0 0);
  --sidebar-border: oklch(1 0 0 / 10%);
  --sidebar-ring: oklch(0.556 0 0);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}
</file>

<file path="src/lib/API.ts">
// frontend/src/lib/moveMateApi.ts

export const askMoveMate = async (question: string): Promise<string> => {
  try {
    // Ne conectăm la backend-ul Python local
    const response = await fetch("http://localhost:8000/ask", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({ prompt: question }),
    });

    if (!response.ok) {
      throw new Error("Eroare server");
    }

    const data = await response.json();
    return data.answer;
  } catch (error) {
    console.error("MoveMate API Error:", error);
    return "⚠️ Eroare: Nu pot contacta MoveMate. Verifică dacă serverul Python (backend) este pornit.";
  }
};
</file>

<file path="src/lib/utils.ts">
import { type ClassValue, clsx } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}
</file>

<file path="src/main.tsx">
import React from 'react'
import ReactDOM from 'react-dom/client'
import '@mysten/dapp-kit/dist/index.css'; // Stiluri pentru butonul de wallet

import { SuiClientProvider, WalletProvider, createNetworkConfig } from '@mysten/dapp-kit';
import { getFullnodeUrl } from '@mysten/sui.js/client';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';

import App from './App.tsx'
import './index.css'

// 1. Configurăm rețeaua (Testnet)
const { networkConfig } = createNetworkConfig({
	testnet: { url: getFullnodeUrl('testnet') },
	mainnet: { url: getFullnodeUrl('mainnet') },
});

// 2. Clientul pentru cache-ul de date
const queryClient = new QueryClient();

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <QueryClientProvider client={queryClient}>
      <SuiClientProvider networks={networkConfig} defaultNetwork="testnet">
        <WalletProvider autoConnect={true}>
          <App />
        </WalletProvider>
      </SuiClientProvider>
    </QueryClientProvider>
  </React.StrictMode>,
)
</file>

<file path="tsconfig.app.json">
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.app.tsbuildinfo",
    "target": "ES2022",
    "useDefineForClassFields": true,
    "baseUrl": ".",
    "paths": {
      "@/*": [
        "./src/*"
      ]
    },
    "lib": ["ES2022", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "types": ["vite/client"],
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "noEmit": true,
    "jsx": "react-jsx",

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["src"]
}
</file>

<file path="tsconfig.json">
{
  "files": [],
  "references": [
    { "path": "./tsconfig.app.json" },
    { "path": "./tsconfig.node.json" }
  ],
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  }
}
</file>

<file path="tsconfig.node.json">
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.node.tsbuildinfo",
    "target": "ES2023",
    "lib": ["ES2023"],
    "module": "ESNext",
    "types": ["node"],
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "noEmit": true,

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["vite.config.ts"]
}
</file>

<file path="vite.config.ts">
import path from "path"
import tailwindcss from "@tailwindcss/vite"
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

// https://vite.dev/config/
export default defineConfig({
    plugins: [react(), tailwindcss()],
    resolve: {
        alias: {
            "@": path.resolve(__dirname, "./src"),
        },
    },
})
</file>

</files>
